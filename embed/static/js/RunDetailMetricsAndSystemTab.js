(this.webpackJsonpui_v2=this.webpackJsonpui_v2||[]).push([[8],{1070:function(e,t,n){"use strict";n.r(t);var a=n(19),i=n.n(a),r=n(2),c=n(57),o=n(6),s=n(0),u=n(63),l=n(258),d=n(343),f=n(259),b=n(11),m=n(5),x=n(17),v=n(14),g=n(745),h=n(246),j=n(56),R=n(107),O=n(167),p=n(59),y=n(7),_=n(325),S=n(698),N=n(27),C=n(18),A=n(85),w=n(1);function T(e){var t,n=e.batch,a=e.index,i=e.observer,r=e.isPinned,c=e.togglePin,o=s.useRef(null);return s.useEffect((function(){o.current&&i&&i.observe(o.current)}),[i]),Object(w.jsx)(b.a,{children:Object(w.jsxs)("div",{className:"RunDetailMetricsTab__container__chartContainer","data-name":n.name,"data-context":Object(R.a)(n.context),ref:o,children:[Object(w.jsx)(_.a,{title:r?"Unpin":"Pin",children:Object(w.jsx)("div",{className:"RunDetailMetricsTab__container__chartContainer__metricDetailBox__pin",children:Object(w.jsx)(m.c,{color:r?"primary":"default",size:"xSmall",variant:"outlined",withOnlyIcon:!0,onClick:function(){return c({name:n.name,context:n.context},r)},children:Object(w.jsx)(m.f,{name:"pin"})})})}),Object(w.jsx)("div",{className:"RunDetailMetricsTab__container__chartContainer__chartBox",children:n.iters?Object(w.jsx)(b.a,{children:Object(w.jsx)(S.a,{data:[{key:n.key,data:{xValues:Object(y.a)(n.iters),yValues:Object(y.a)(n.values)},color:"#1c2852",dasharray:"none",selectors:[n.key]}],index:a,axesScaleType:{xAxis:C.h.Linear,yAxis:C.h.Linear},ignoreOutliers:!1,highlightMode:C.e.Off,curveInterpolation:C.d.Linear})}):Object(w.jsx)(m.l,{})}),Object(w.jsxs)("div",{className:"RunDetailMetricsTab__container__chartContainer__metricDetailBox",children:[Object(w.jsx)(m.n,{component:"h4",tint:100,size:18,weight:600,className:"RunDetailMetricsTab__container__chartContainer__metricDetailBox__metricName",children:Object(j.a)(null===n||void 0===n?void 0:n.name)?Object(A.a)(null===n||void 0===n?void 0:n.name):null===n||void 0===n?void 0:n.name}),null===(t=Object(R.a)(null===n||void 0===n?void 0:n.context))||void 0===t?void 0:t.split(",").map((function(e,t){return Object(w.jsx)(m.b,{monospace:!0,size:"large",color:N.c[0][(t+a)%N.c[0].length],label:e||"Empty context"},t)}))]})]})})}var D=s.memo(T);function M(e){for(var t=e.runHash,n=e.runTraces,a=e.runBatch,y=e.isSystem,_=e.isRunBatchLoading,S=s.useRef(null),N=s.useRef(),C=s.useState(!1),A=Object(o.a)(C,2),T=A[0],M=A[1],B=s.useState([]),L=Object(o.a)(B,2),k=L[0],z=L[1],E=Object(l.b)(h.a,!1),H=s.useMemo((function(){return n.metric.filter((function(e){return y?Object(j.a)(e.name):!Object(j.a)(e.name)}))}),[n.metric,y]),I=[],q=[],P=function(e){var t,n,a=H[e],i=null!==(t=null===E||void 0===E||null===(n=E.pinnedSequences)||void 0===n?void 0:n.findIndex((function(e){return e.name===a.name&&Object(R.a)(e.context)===Object(R.a)(a.context)})))&&void 0!==t?t:-1;i>-1?I[i]=a:q.push(a)},F=0;F<H.length;F++)P(F);function K(e,t){return V.apply(this,arguments)}function V(){return(V=Object(c.a)(i.a.mark((function e(t,n){var a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=n?I.filter((function(e){return!(e.name===t.name&&Object(R.a)(e.context)===Object(R.a)(t.context))})):[].concat(I,[t]),r=h.a.setPinnedSequences({sequences:a},(function(e){h.a.setState({pinnedSequences:I}),Object(p.a)({detail:e,model:g.a})})),h.a.setState({pinnedSequences:a}),r.call();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e,t){return T&&e.length>0&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"RunDetailMetricsTab__header",children:Object(w.jsxs)(m.n,{component:"h3",size:16,color:"primary",children:[t?"Pinned ":"","Metrics"]})}),Object(w.jsx)("div",{className:"RunDetailMetricsTab__container",children:(t?e:e.map((function(e){return Object(r.a)(Object(r.a)({},e),{},{sortKey:"".concat(e.name,"_").concat(Object(R.a)(e.context))})})).sort(Object(O.a)({orderBy:"sortKey"}))).map((function(e,n){var i=Object(r.a)(Object(r.a)({},e),null===a||void 0===a?void 0:a.find((function(t){return t.name===e.name&&Object(R.a)(t.context)===Object(R.a)(e.context)})));return Object(w.jsx)(D,{batch:i,index:n,observer:N.current,isPinned:t,togglePin:K},"".concat(i.name,"_").concat(Object(R.a)(i.context)))}))})]})}return I.filter((function(e){return!!e})),s.useEffect((function(){if(S.current){var e,t={root:null===(e=S.current.parentElement)||void 0===e?void 0:e.parentElement,rootMargin:"0px",threshold:0};N.current=new IntersectionObserver((function(e){var t=[];e.forEach((function(e){if(e.isIntersecting){var n=e.target.getAttribute("data-name"),i=e.target.getAttribute("data-context");(null===a||void 0===a?void 0:a.find((function(e){return e.name===n&&Object(R.a)(e.context)===i})))||t.push({name:n,context:i})}})),t.length>0&&z((function(e){return e.concat(t.map((function(e){return H.find((function(t){return t.name===e.name&&Object(R.a)(t.context)===e.context}))})))}))}),t),M(!0)}return v.a(x.a.runDetails.tabs[y?"system":"metrics"].tabView),function(){N.current&&N.current.disconnect()}}),[y,a,T,n.metric,H]),s.useEffect((function(){var e,n;return k.length>0&&(e=window.setTimeout((function(){(n=g.a.getRunMetricsBatch(k,t)).call()}),100)),function(){e&&clearTimeout(e),n&&n.abort()}}),[k,t]),s.useEffect((function(){z((function(e){return e.filter((function(e){return-1===a.findIndex((function(t){return t.name===e.name&&Object(R.a)(t.context)===Object(R.a)(e.context)}))}))}))}),[a]),Object(w.jsx)(b.a,{children:Object(w.jsx)(f.a,{isLoading:_,className:"RunDetailTabLoader",height:"100%",children:u.a.isEmpty(H)?Object(w.jsx)(d.a,{size:"xLarge",className:"RunDetailTabLoader",title:"No tracked ".concat(y?"system":""," metrics")}):Object(w.jsxs)("div",{className:"RunDetailMetricsTab",ref:S,children:[J(I,!0),J(q,!1)]})})})}t.default=s.memo(M)},680:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var a=100,i={S:4,M:6,L:12},r=i.S,c=i.M,o={1:[i.L],2:[c,c],3:[r,r,r],4:[c,c,c,c],5:[r,r,r,c,c],6:[r,r,r,r,r,r],7:[r,r,r,c,c,c,c],8:[r,r,r,r,r,r,c,c],9:[r,r,r,r,r,r,r,r,r]}},698:function(e,t,n){"use strict";var a=n(0),i=n.n(a),r=n(16),c=n.n(r),o=n(258),s=n(11),u=n(680),l=n(18),d=(n(699),n(1)),f=i.a.forwardRef((function(e,t){var n=e.data,a=e.index,r=void 0===a?0:a,f=e.nameKey,b=void 0===f?"":f,m=e.aggregatedData,x=e.aggregationConfig,v=e.syncHoverState,g=e.axesScaleType,h=e.axesScaleRange,j=e.ignoreOutliers,R=void 0!==j&&j,O=e.alignmentConfig,p=e.highlightMode,y=void 0===p?l.e.Off:p,_=e.curveInterpolation,S=void 0===_?l.d.Linear:_,N=e.chartTitle,C=e.zoom,A=e.onZoomChange,w=e.readOnly,T=void 0!==w&&w,D=e.resizeMode,M=i.a.useRef({margin:{top:30,right:20,bottom:30,left:60},height:0,width:0}),B=i.a.useRef({height:0,width:0}),L=i.a.useRef(null),k=i.a.useRef(null),z=i.a.useRef(null),E=i.a.useRef(null),H=i.a.useRef(null),I=i.a.useRef(null),q=i.a.useRef(null),P=i.a.useRef(null),F=i.a.useRef(null),K=i.a.useRef(null),V=i.a.useRef(null),J=i.a.useRef({}),Z=i.a.useRef({}),U=i.a.useRef({}),G=i.a.useRef({}),Q=i.a.useRef(),W=[];function X(){Object(l.k)({visAreaRef:k}),function(){Object(l.l)({index:r,nameKey:b,visBoxRef:M,plotBoxRef:B,parentRef:L,visAreaRef:k,svgNodeRef:z,bgRectNodeRef:E,plotNodeRef:H,axesNodeRef:I,linesNodeRef:q,attributesNodeRef:P,chartTitle:N});var e=Object(l.C)({data:n,ignoreOutliers:R,visBoxRef:M,axesScaleType:g,axesScaleRange:h,aggregatedData:m,aggregationConfig:x,unableToDrawConditions:W,attributesRef:U}),t=e.processedData,a=e.processedAggrData,i=e.min,c=e.max;Object(l.m)({svgNodeRef:z,axesNodeRef:I,axesRef:J,plotBoxRef:B,xScale:U.current.xScale,yScale:U.current.yScale,visBoxRef:M,alignmentConfig:O,axesScaleType:g,humanizerConfigRef:G,drawBgTickLines:{y:!0,x:!1}}),Object(l.q)({index:r,processedData:t,nameKey:b,linesNodeRef:q,linesRef:Z,curveInterpolation:S,xScale:U.current.xScale,yScale:U.current.yScale,highlightMode:y,aggregationConfig:x,processedAggrData:a,readOnly:T}),!T&&q.current&&q.current.selectChildren().size()>u.c&&q.current.classed("optimizeRendering",!0),Object(l.n)({index:r,plotBoxRef:B,plotNodeRef:H,visBoxRef:M,axesRef:J,attributesRef:U,linesRef:Z,svgNodeRef:z,axesScaleType:g,min:i,max:c,axesScaleRange:h,zoom:C,onZoomChange:A,readOnly:T,unableToDrawConditions:W}),T||Object(l.o)({index:r,nameKey:b,data:n,processedData:t,axesScaleType:g,highlightMode:y,syncHoverState:v,visAreaRef:k,attributesRef:U,plotBoxRef:B,visBoxRef:M,svgNodeRef:z,bgRectNodeRef:E,attributesNodeRef:P,xAxisLabelNodeRef:F,yAxisLabelNodeRef:K,linesNodeRef:q,highlightedNodeRef:V,aggregationConfig:x,alignmentConfig:O}),Object(l.y)({renderArr:W,visAreaRef:k,attributesRef:U,readOnly:T,syncHoverState:v})}()}var Y=i.a.useCallback((function(e){(null===e||void 0===e?void 0:e.length)&&(Q.current=window.requestAnimationFrame(X))}),[n,C,R,y,g,h,S,x,T,O,D]),$=i.a.useCallback((function(){Q.current&&window.cancelAnimationFrame(Q.current)}),[]);return Object(o.d)(Y,L,$),i.a.useEffect((function(){return Q.current=window.requestAnimationFrame(X),function(){Q.current&&window.cancelAnimationFrame(Q.current)}}),[n,C,R,y,g,h,S,x,T,O,D]),i.a.useImperativeHandle(t,(function(){return{setActiveLineAndCircle:function(e){var t,n,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];null===(t=(n=U.current).setActiveLineAndCircle)||void 0===t||t.call(n,e,a,i)},updateHoverAttributes:function(e,t){var n,a;null===(n=(a=U.current).updateHoverAttributes)||void 0===n||n.call(a,e,t)},clearHoverAttributes:function(){var e,t;null===(e=(t=U.current).clearHoverAttributes)||void 0===e||e.call(t)},setFocusedState:function(e){U.current.focusedState=e}}})),Object(d.jsx)(s.a,{children:Object(d.jsx)("div",{ref:L,className:c()("LineChart",{zoomMode:!T&&(null===C||void 0===C?void 0:C.active)}),children:Object(d.jsx)("div",{ref:k})})})}));f.displayName="LineChart",t.a=i.a.memo(f)},699:function(e,t,n){}}]);